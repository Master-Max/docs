******
4.11.5
******

==================================
Новая функциональность и улучшения
==================================

[+] Заказы: Для работы с выделенными заказами было добавлено контекстное меню.

[+] Импорт/Экспорт: Теперь можно импортировать файлы в кодировке UTF-16.

[+] Категории: Для работы с выделенными категориями было добавлено контекстное меню.

[+] Модули: АТОЛ Онлайн: Добавлена настройка статусов предоплаченных заказов, при которых на онлайн-кассе должен пробиваться чек предоплаты.

[+] Модули: Пиксель Facebook: Добавлено отслеживание валюты и суммы заказа при размещении заказа.

[+] Модули: Поиск от Searchanise: Добавлена возможность запускать очереди Searchanise через CRON. 

[+] Модули: Яндекс.Касса: Возврат товаров: Добавлена поддержка возврата средств для заказов, оплаченных с помощью способа оплаты с процессором "Яндекс.Касса".

[+] Модули: Яндекс.Касса: Добавлена возможность выбора способа оплаты, которые будут предложены покупателю на стороне Яндекс.Кассы при оформлении заказа.

[+] Модули: Яндекс.Касса: Добавлена возможность холдирования платежей.

[+] Модули: CommerceML [Beta]: Добавлен новый модуль для интеграции CS-Cart и Multi-Vendor с "1С: Управление торговлей", "МойСклад", "Бизнес.Ру" (Класс365).

[+] Страны: Для работы с выделенными странами было добавлено контекстное меню.

[+] Multi-Vendor: Модули: PayPal Commerce Platform: Добавлен новый модуль для автоматического распределения средств между продавцами через PayPal.

[+] Multi-Vendor: Модули: Обратный звонок: Добавлена настройка, позволяющая продавцам работать с запросами на обратный звонок.

[+] Multi-Vendor: Модули: Яндекс.Касса: Добавлена поддержка гибкой комиссии (в зависимости от тарифного плана) в процессоре "Яндекс.Касса для платформ".

[+] Multi-Vendor: Продавцы: Для работы с выделенными продавцами было добавлено контекстное меню.

[+] Multi-Vendor Ultimate: Панель инструментов теперь показывает статистику по выбранной витрине.

=========================================
Изменения в существующей функциональности
=========================================

[*] Дизайн: Товары: В панели администратора улучшен выбор категорий на списке товаров в форме поиска.

[*] Загрузчик: Иконка загрузки была заменена на CSS-анимацию.

[*] Заказы: Дизайн: Улучшен выбор менеджера заказа.

[*] Модули: Boxberry: Добавлена кнопка выбора пункта выдачи заказа на странице оформления заказа.

[*] Настройки: Часовые пояса: Обновлён список часовых поясов.

[*] Настройки: Электронная почта: Добавлена проверка настроек SMTP-сервера.

[*] Способы доставки: Australia Post: Обновлён список служб доставки.

[*] Ядро: Файловый менеджер (elFinder) обновлён до версии 2.1.56.

[*] Ядро: JavaScript: jQuery обновлён до версии 3.5.1.

[*] Ядро: Улучшена совместимость с PHP 7.4.

[*] Multi-Vendor: Дизайн: Тарифные планы для продавцов: Описание было перенесено под список ограничений плана.

[*] Multi-Vendor: Модули: Тарифные планы для продавцов: Redactor II был добавлен для поля "Описание" у тарифного плана.

[*] Multi-Vendor: Уведомления: Улучшены уведомления при регистрации продавцов.

==================
Исправления ошибок
==================

[!] Витрины: При указании витрины с нестандартным портом происходило перенаправление на витрину без порта. Исправлено.

[!] Витрины: Темы: На странице редактирования витрины появлялась ошибка при установленной сторонней теме. Исправлено.

[!] Группы пользователей: Страница "Запросы на добавление в группу" отображалась не на всю ширину экрана. Исправлено.

[!] Дизайн: Блоки: Внешняя навигация в шаблоне "Сколлер" наезжала на соседний блок. Исправлено.

[!] Дизайн: Блоки: Товары: Блок с шаблоном "Скроллер" не отображался на странице более одного раза. Исправлено.

[!] Дизайн: Заголовок быстрого просмотра товара не отображался в Firefox. Исправлено.

[!] Дизайн: Макеты: В качестве "Шаблона" или "Оболочки" для блока и секции можно было указать несоответствующий файл. Исправлено.

[!] Дизайн: Центр обновлений: Заголовок всплывающего окна мог перекрывать кнопку закрытия этого окна. Исправлено.

[!] Дизайн: Флажок, радиокнопка и выпадающий список неправильно отображались в Chrome 83+. Исправлено.

[!] Заказы: Когда выполнялось повторное добавление товара в заказ, количество было неверным. Исправлено.

[!] Заказы: Налоги: Название налога в письме отображалось без учёта языка заказа. Исправлено.

[!] Импорт/Экспорт: Товары импортировались неправильно, если был указан "Размер коробки", но не указано "Количество штук в коробке". Исправлено.

[!] Модули: Бонусные баллы: Ссылки на просмотр бонусных балов покупателя отображались администратору, даже если у него не было прав для этого и он не мог увидеть баллы. Исправлено.

[!] Модули: Вариации товаров: Передача нечисловых значений в product_id могла приводить к ошибкам БД. Исправлено.

[!] Модули: Водяные знаки: При генерации изображений с водяными знаками для товаров могли использоваться настройки от категорий, и наоборот. Исправлено.

[!] Модули: Карты и геолокация: Поля профиля: Оформление заказа: При включенной настройке "Покупатель должен зарегистрироваться либо войти, чтобы оформить заказ" могла возникать ошибка "Service unavailable". Исправлено.

[!] Модули: Карты и геолокация: Яндекс.Карты не масштабировалась колесом мыши в полноэкранном режиме. Исправлено.

[!] Модули: Магазины и пункты самовывоза: Импорт/экспорт магазинов и пунктов самовывоза был доступен, даже если у администратора не было доступа на просмотр или редактирование магазинов и пунктов самовывоза. Исправлено.

[!] Модули: Магазины и пункты самовывоза: Информация о выбранном пункте самовывоза удалялась из заказа при обновлении его через REST API. Исправлено.

[!] Модули: Отзывы и комментарии: Отзывы и комментарии не отображались на странице категорий. Исправлено.

[!] Модули: Платежи через PayPal: В некоторых случаях при размещении заказа статус заказа мог неправильно смениться на "Отложен", если у способа оплаты в качестве начального статуса заказа был выбран "Открыт". Исправлено.

[!] Модули: Подарочные сертификаты: У окна проверки подарочного сертификата был неправильный заголовок. Исправлено.

[!] Модули: Поиск от Searchanise: Если пользователь внес изменения в код, могла возникнуть ошибка вида undefined index 'value'. Исправлено.

[!] Модули: Поиск от Searchanise: Модуль в статусе “Выключен” невозможно было включить. Исправлено. 

[!] Модули: Поставщики: Выключенный поставщик всё ещё мог получать письма о смене статуса заказа, содержащего поставляемый им товар. Исправлено.

[!] Модули: Поставщики: Иногда один из поставщиков не отображался среди доступных поставщиков на странице редактирования товара. Исправлено.

[!] Модули: Почта России: Города: Почтовые индексы населенных пунктов Анапа, Усть-Илимск, Витязево, ст. Мигулинская, Новокузнецк, Пречистое и Костинка были неактуальными. Исправлено.

[!] Модули: Почта России: Некорректное значение параметра "Среднее количество в пакете" могло вызывать ошибки при расчете способа доставки. Исправлено.

[!] Модули: Рассылки: Могла произойти ошибка при отправке рассылки, если ни один список рассылки не был выбран. Исправлено.

[!] Модули: Рассылки: В письме не было ссылки, чтобы отписаться от рассылки. Исправлено.

[!] Модули: Расширенный импорт товаров: Не импортировалось значение "0" из элементов "param" в XML-файлах. Исправлено.

[!] Модули: Российские способы оплаты: На iOS 13 символ рубля не отображался. Исправлено.

[!] Модули: СДЭК: Возникала ошибка при создании отгрузки в Белоруссию. Исправлено.

[!] Модули: Склады [Beta]: Если в магазине не было настроено местоположение покупателя по умолчанию, а местоположение покупателя не было определено, то страница могла циклически перегружаться. Исправлено.

[!] Модули: Склады [Beta]: Импорт товаров с включенной опцией "Уменьшить количество товаров до нуля" работал некорректно. Исправлено.

[!] Модули: Склады [Beta]: Импорт: Количество товаров могло импортироваться для склада, недоступного для витрины, которой принадлежал импортируемый товар. Исправлено.

[!] Модули: Социальные кнопки: У кнопки Pinterest была настройка "Цвет", хотя Pinterest не предоставляет возможность менять цвет. Исправлено.

[!] Модули: Увеличенные изображения товаров: Вариации товаров: После переключения характеристик не работал просмотр увеличенных изображений. Исправлено.

[!] Модули: Задать вопрос продавцу: Ссылка на сообщение в письме с ответом администратора вела не на ту витрину. Исправлено.

[!] Модули: Экспорт в Яндекс.Маркет: Параметр "Исключить экспорт" некорректно работал вместе с настройкой "Экспорт общих товаров". Исправлено.

[!] Модули: Экспорт в Яндекс.Маркет: Некорректно экспортировался вес в Яндекс.Маркет при использовании единицы веса, отличной от килограмма. Исправлено.

[!] Модули: Экспорт в Яндекс.Маркет: Формат даты в заголовке задавался некорректно. Исправлено.

[!] Модули: Яндекс Метрика: Если была поставлена цель, то на странице с 404 ошибкой была JS-ошибка. Исправлено.

[!] Модули: CommerceML: Вариант характеристики не добавлялся к товару в процессе импорта из системы учета, если поменять тип фильтра у характеристики на "Цвет". Исправлено.

[!] Модули: CommerceML: Товару присваивалась только одна категория. Исправлено.

[!] Модули: Email-маркетинг: Интеграция с MailChimp не работала. Исправлено.

[!] Модули: Google ReCAPTCHA: Окно входа в учётную запись: Если ввести неверный логин/пароль и пройти CAPTCHA, то после сообщения о неверном пароле выдавалось сообщение о том, что тест CAPTCHA не пройден. Исправлено.

[!] Модули: Pickpoint: Оформление заказа: Выбранный постамат сохранялся после смены города доставки. Исправлено.

[!] Модули: Pickpoint: При установке модуля или обновлении списка ПВЗ могла возникнуть ошибка из-за нехватки памяти. Исправлено.

[!] Модули: SEO: Вариации товаров: В разметке JSON-LD не отображались характеристики SKU, GTIN и MPN для вариаций товара. Исправлено.

[!] Модули: SEO: Вариации товаров: Вариации как один товар не отображались в разметке JSON-LD. Исправлено.

[!] Модули: SEO: Доступный по предзаказу товар в данных schema.org для поисковой системы отображался как OutOfStock. Исправлено.

[!] Модули: SEO: Код характеристики "Brand" в подсказке был переведен на другие языки, хотя должен был вводиться на английском. Исправлено.

[!] Модули: SEO: При составлении URL пропускались буквы украинского языка. Исправлено.

[!] Модули: SEO: Характеристики товара: При создании характеристики не отображалась подсказка с доступными кодами. Исправлено.

[!] Модули: SEO: При определённых настройках характеристики бренд могла возникать ошибка PHP Notice. Исправлено.

[!] Опции товара: Выбранное значение для опции "Флажок" или "Радиогруппа" сбрасывалось при обновлении содержимого корзины, если был выбран последовательный тип опций, а опция была не первой в списке. Исправлено.

[!] Оформление заказа: В некоторых случаях при изменении страны не обновлялись способы доставки. Исправлено.

[!] Оформление заказа: Если регион покупателя по умолчанию не был выбран, то выбирался первый регион страны. Исправлено.

[!] Оформление заказа: Когда фокус переходил на поле "Телефон", то курсор не всегда становился в начало строки. Исправлено.

[!] Оформление заказа: Способ оплаты в iframe не блокировался, пока покупатель не согласился с условиями продажи. Исправлено.

[!] Оформление заказа: При оформлении заказа стоимость доставки рассчитывалась несколько раз, даже когда это не было необходимо. Исправлено.

[!] Панель инструментов: У предыдущего периода в статистике был неправильный заголовок. Исправлено.

[!] Пользователи: Профили: Если страна пользователя не совпадала со страной по умолчанию, то в панели администратора в профиле нельзя было удалить область. Исправлено.

[!] Почтовые уведомления: Старый режим редактирования: Не было возможности указать разные значения для полей "Тема email" и "Заголовок email" для витрин. Исправлено.

[!] Расширенный поиск: При поиске по региону выводились лишние записи. Исправлено.

[!] Способы доставки: DHL: Кодировка UTF-8 не поддерживалась. Исправлено.

[!] Способы доставки: DHL: Сервис не работал, если в настройках магазина была указана страна, которая отличалась от страны аккаунта DHL. Исправлено.

[!] Способы доставки: Доступность способов доставки на одной витрине могло повлиять на оформление заказа на другой витрине. Исправлено.

[!] Способы оплаты: Global Payments Redirect: В передаваемом на сторону способа оплаты адресе не убирались недопустимые символы. Исправлено.

[!] Статусы заказов: Покупатель мог скачать цифровой товар, даже если он не был оплачен, если статус заказа менялся на пользовательский. Исправлено.

[!] Страницы: Меню: В панели администратора цветом выделялся неправильный пункт меню. Исправлено.

[!] Товары: При изменении свойства "Цифровой товар" у товара в панели администратора возникала ошибка JavaScript. Исправлено.

[!] Товары: Выделение на списке товаров в панели администратора могло перестать работать. Исправлено.

[!] Товары: Количество: Предзаказ: Когда товара не было в наличии, но был доступен предзаказ, не всегда можно было задать нужное количество на странице товара. Исправлено.

[!] Товары: Опции: Если пользователь вводил цену и выбирал обязательную опцию, то  поле с ценой очищалось. Исправлено.

[!] Товары: Опции: При удалении опции она не удалялась из недоступных комбинаций. Исправлено.

[!] Товары: Производительность: Массовое обновление товаров могло приводить к проблемам с производительностью, если в магазине присутствовало большое количество категорий. Исправлено.

[!] Установка: Выполнение установки с некоторыми значениями параметров подключения к базе данных могло привести к ошибке. Исправлено.

[!] Файлы: Некоторые операции с файлами в файловом менеджере были запрещены. Исправлено.

[!] Характеристики товаров: Характеристики товаров с внешним видом "Бренд" были неправильно отсортированы в алфавитном порядке на витрине. Исправлено.

[!] Электронная почта: Витрины: При смене статуса заказа в режиме "Все витрины" использовался шаблон уведомлений и ссылки на товары с основной витрины. Исправлено.

[!] Ядро: Способы оплаты: Выводилось неверное сообщение об ошибке при заполнении данных кредитной карты в шаблоне сс.tpl. Исправлено.

[!] Ядро: Характеристики товара: Сбрасывались некоторые настройки характеристики при повторном открытии. Исправлено.

[!] Ядро: JS: Выбор объектов: Выбор объектов во всплывающем окне был сломан. Исправлено.

[!] Языки: При использовании некоторых префиксов таблиц новый язык устанавливался неправильно. Исправлено.

[!] Multi-Vendor: Логотипы: Продавцы: В некоторых случаях при создании продавца ему присваивались логотипы витрины, установленной не по умолчанию. Исправлено.

[!] Multi-Vendor: Модули: Выплата долгов продавцов: Промо-акция для каталога применялась также к оплате долга продавцом. Исправлено.

[!] Multi-Vendor: Модули: Магазины и пункты самовывоза: При удалении продавца не удалялись пункты выдачи заказов. Исправлено.

[!] Multi-Vendor: Модули: Магазины и пункты самовывоза: Продавец, недоступный на выбранной витрине, мог быть выбран на странице поиска магазинов и пунктов самовывоза. Исправлено.

[!] Multi-Vendor: Модули: Местоположение продавцов [Beta]: В блоке "Ближайшие продавцы" была некорректная сортировка продавцов. Исправлено.

[!] Multi-Vendor: Модули: Общие товары продавцов: Подсказка "Все продавцы (общий товар)" отображалась в панели администратора для объектов, не являющихся товарами. Исправлено.

[!] Multi-Vendor: Модули: Российские способы оплаты: Робокасса: На странице способа оплаты появлялось уведомление "Доступ запрещен". Исправлено.

[!] Multi-Vendor: Модули: Тарифные планы для продавцов: Бухгалтерский учёт: Комиссия рассчитывалась неправильно, если плата за транзакцию в тарифном плане была 0%. Исправлено.

[!] Multi-Vendor: Модули: Тарифные планы для продавцов: Изменения стоимости доставки в сформированном заказе не влияли на доход продавца в некоторых случаях. Исправлено.

[!] Multi-Vendor: Модули: Тарифные планы для продавцов: Комиссия продавца: Если стоимость заказа увеличивалась после оформления, то комиссия разницы была нулевой. Исправлено.

[!] Multi-Vendor: Модули: Тарифные планы для продавцов: Налог на способ доставки добавлялся в расчет комиссии продавца. Исправлено.

[!] Multi-Vendor: Товары: Опции: К товару продавца можно было привязать опции другого продавца. Исправлено.

[!] Multi-Vendor: Товары: Опции: Продавец не мог убрать у товара глобальную опцию. Исправлено.

[!] Multi-Vendor: Экспорт/Импорт: Опции товара: Через импорт товаров продавцы могли создать глобальную общую опцию, которая принадлежит администратору магазина. Исправлено.

[!] Multi-Vendor: Экспорт/Импорт: Продавцы: Поля "Телефон", "Адрес", "Город", "Страна", "Область" и "Индекс" должны были присуствовать при импорте продавцов, хотя их можно было отключить. Исправлено.

[!] Multi-Vendor: Экспорт/импорт: Модули: Склады [Beta]: Продавец мог видеть чужие склады при импорте. Исправлено.

[!] Multi-Vendor: Ядро: Опции товара: Паджинация на списке опций у продавца учитывала общее количество всех опций в магазине. Исправлено.

[!] Multi-Vendor Plus: Модули: Зависимости для способов оплаты: Оплата напрямую продавцам: У продавцов не было возможности назначить общие способы оплаты способам доставки. Исправлено.

[!] Multi-Vendor Plus: Модули: Общие товары для продавцов: Блок для отображения предложений от продавцов использовал неоптимальный запрос в БД, что повышало нагрузку на магазин. Исправлено.

[!] Multi-Vendor Plus: Модули: Общие товары для продавцов: На витрине у продавца отображалось неверное количество товаров, если у него были товарные предложения для общих товаров. Исправлено.

[!] Multi-Vendor Plus: Модули: Общие товары для продавцов: Передача нечисловых значений в product_id могло приводить к ошибкам БД. Исправлено.

[!] Multi-Vendor Plus: Модули: Общие товары для продавцов: Премодерация данных продавцов: Продавец мог создать свой товар, несмотря на включенный запрет. Исправлено.

[!] Multi-Vendor Plus: Модули: Общие товары для продавцов: Продавец не мог импортировать оптовые скидки для товарного предложения. Исправлено.

[!] Multi-Vendor Plus: Модули: Общие товары для продавцов: Создание товарного предложения для общего товара могло привести к SQL-ошибке. Исправлено.

[!] Multi-Vendor Plus: Модули: Общие товары для продавцов: Товар, добавленный в корзину из списка "Предложения от продавцов", нельзя было удалить из корзины без обновления страницы. Исправлено.

[!] Multi-Vendor Plus: Модули: Общие товары для продавцов: Хиты продаж и товары со скидкой: В блоках товаров с заполнением по популярности игнорировалась популярность дочерних товаров. Исправлено.

[!] Multi-Vendor Plus: Модули: Общие товары для продавцов: Цена общего товара, по идее доступная только для чтения, отображалась как редактируемая. Исправлено.

[!] Multi-Vendor Plus: Модули: Оплата напрямую продавцам: Города: Окно оценки стоимости доставки на странице корзины могло не содержать список стран. Исправлено.

[!] Multi-Vendor Plus: Модули: Оплата напрямую продавцам: Если добавить в корзину товары от разных продавцов, то общее их количество в подсказке "X товар(ов) в корзине" могло быть неправильным. Исправлено.

[!] Multi-Vendor Plus: Модули: Оплата напрямую продавцам: Способы доставки: У администратора на странице настройки способа доставки не работал выбор продавца. Исправлено.

[!] Multi-Vendor Plus: Модули: Отзывы и комментарии: При включенной настройке "Отзывы только от покупателей" покупатель не мог оставить отзыв для общего товара. Исправлено.

[!] Multi-Vendor Plus: Модули: Расширенный импорт товаров: Общие товары для продавцов: SEO: При импорте товаров не учитывалось их количество. Исправлено.

[!] Multi-Vendor Plus: Модули: Тинькофф: Кредитование покупателей (КупиВкредит): Оплата напрямую продавцам: Кнопка оплаты на детальной странице товара могла отображаться на всех товарах магазина. Исправлено.

[!] Multi-Vendor Ultimate: Дизайн: Темы: Некоторые темы могли функционировать неправильно, если на разных витринах использовались разные темы. Исправлено.

[!] Multi-Vendor Ultimate: Модули: Местоположение продавцов: Карта расположения показывала всех продавцов, а не продавцов с текущей витрины. Исправлено.

[!] Multi-Vendor Ultimate: Товары: При предпросмотре товар мог открываться на неверной витрине. Исправлено.
