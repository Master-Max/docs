******
4.14.3
******

==================================
Новая функциональность и улучшения
==================================

[+] Модули: Карта сайта для Yandex и Google: Добавлена консольная команда для автоматической перегенерации карты сайта в Cron.

[+] Модули: Отзывы о товарах: Добавлена возможность создавать отзывы о товарах в панели администратора и через API.

[+] Модули: Boxberry: Добавлена поддержка доставки в страны ЕАЭС (Казахстан, Беларусь, Киргизия, Армения)

[+] Языки: Языковая переменная "Поиск" была разделена на несколько языковых переменных в зависимости от назначения (для панели администратора, витрины, заголовков, кнопок, текстовых полей, меток полей, главного поля).

[+] Multi-Vendor: Мобильное приложение: Добавлена возможность скрывать информацию о продавце на странице товара в мобильном приложении.

[+] Multi-Vendor Plus: Модули: Общие товары для продавцов: API: Добавлены сущности для работы с общими товарами.

=========================================
Изменения в существующей функциональности
=========================================

[*] Способы доставки: Уведомления: Теперь уведомления об ошибках способа доставки будут отправляться не чаще, чем через установленный период.

[*] Дизайн: Промо-акции и скидки: Обновлен внешний вид сообщения "Действующих акций и спецпредложений в данный момент нет".

[*] Комплекты товаров: Обновлен внешний вид комплектов товаров на витрине.

[*] Редактирование заказа: Кнопка "Cохранить и оплатить" удалена со страниц создания и редактирования заказа.

[*] Модули: Google reCaptcha: Обязательные поля были добавлены в настройках.

[*] Пользователи: Тип пользователя больше нельзя изменять на странице редактирования пользователя.

[*] API: Для некоторых редакций добавлены ограничения по API.

[*] Multi-Vendor: Модули: Конфигуратор панели продавцов: Добавлена возможность задания стиля панели продавца через config.local.php.

==================
Исправления ошибок
==================

[!] API: Отгрузки: Если для заказа было создано более одной отгрузки, данные отгрузки нельзя было изменить через API. Исправлено.

[!] API: Фильтры: Отображалась ошибка базы данных при GET запросе. Исправлено.

[!] Вкладки: Уведомление о несохраненных данных не отображалось на неактивных вкладках. Исправлено.

[!] Дизайн: RTL-режим: Метка телефона отображалась некорректно на странице профиля. Исправлено.

[!] Дизайн: Responsive: Меню: На планшетах нажатие на меню не открывало подменю. Исправлено.

[!] Дизайн: Макеты: На iOS 15 иконки Apple Pay и Google Pay отображались некорректно. Исправлено.

[!] Дизайн: Некоторые заголовки списков объектов были не в едином стиле. Исправлено.

[!] Дизайн: Панель администратора: Сообщения "Нет данных" были в разных стилях. Исправлено.

[!] Дизайн: Поиск: Панель инструментов отображалась некорректно. Исправлено.

[!] Дизайн: Редактор тем: Кириллические шрифты не применялись. Исправлено.

[!] Дизайн: Редактор тем: Не отображались стрелки у полей. Исправлено.

[!] Дизайн: Страница товара: В мобильной версии на странице товара при длинном описании переключение вкладок не фокусировало видимую область на содержимом вкладки. Исправлено.

[!] Дизайн: Темы: Товары: На мобильных устройствах кнопки увеличения и уменьшения количества товара на витрине имели лишнее подчеркивание. Исправлено.

[!] Дизайн: Товары: Поля с флажками не были выровнены на странице товара во вкладке характеристик. Исправлено.

[!] Дизайн: Товары: Поле "Количество" не вмещало сотни. Исправлено.

[!] Доставка: Производительность: Расчёт доставки мог вызвать большое количество одинаковых запросов к базе данных. Исправлено.

[!] Заказы: Пользователи: Когда поисковый запрос начинался с пробела, в некоторых случаях возникала ошибка PHP Notice. Исправлено.

[!] Заказы: При завершении первого заказа отображался некорректный текст в уведомлении. Исправлено.

[!] Заказы: При создании заказа из панели администратора в окне расширенного поиска по товарам было невозможно повторно выбрать категории. Исправлено.

[!] Заказы: При создании заказа через панель администратора в секцию информации о покупателе автоматически подставлялись данные администратора. Исправлено.

[!] Заказы: Товар с нулевым количеством удалялся из заказа при попытке добавления этого товара в процессе редактирования заказа. Исправлено.

[!] Изображения: HiDPI-миниатюры создавались для всех изображений в панели администратора даже при выключенном модуле "Поддержка HiDPI". Исправлено.

[!] Импорт данных: Кнопка "Импорт" была неправильно расположена на страницах с кнопкой "Помощь". Исправлено.

[!] Импорт: SEO: SEO-имя товара генерировалось неправильно при импорте товара. Исправлено.

[!] Категории: Некоторые категории нельзя было выбрать при массовом добавлени категорий. Исправлено.

[!] Макеты: Язык контента не влиял на макеты в товарах и категориях. Исправлено.

[!] Мобильное приложение: На странице оплаты возникала ошибка. Исправлено.

[!] Мобильное приложение: Модули: Отзывы и комментарии: Отсутствовала кнопка "Написать отзыв" при включенной настройке "Отзывы только от покупателей". Исправлено.

[!] Мобильное приложение: Появлялась ошибка при сохранении поля с типом "Дата". Исправлено.

[!] Модули: Вариации товаров: При включенной настройке "Изменять вариацию по умолчанию, когда её скрывают или она заканчивается на складе" было возможно назначить вариацию по умолчанию, если её нет складе. Исправлено.

[!] Модули: Вариации товаров: При смене вариации по-умолчанию возникала ошибка, если модуль "Отзывы о товарах" установлен, а "Отзывы и комментарии" удалён. Исправлено.

[!] Модули: Вариации товаров: Экспорт/Импорт: В некоторых случаях, при включенной настройке "Изменять вариацию по умолчанию, когда её скрывают или она заканчивается на складе" не изменялась вариация по умолчанию, если её количество в импортируемом файле было равно нулю. Исправлено.

[!] Модули: Города: Городу Сосновый Бор соответствовали несколько значений кода города. Исправлено.

[!] Модули: Кнопка "Обновить" была доступна в ситуации, когда она не должна быть доступна. Исправлено.

[!] Модули: Комплекты товаров: Возникали проблемы при создании комплекта товаров с выбором вариации. Исправлено.

[!] Модули: Комплекты товаров: Выбранное значение опции не применялось к товару из комплекта. Исправлено.

[!] Модули: Комплекты товаров: Добавление товаров в комплект в некоторых случаях работало некорректно. Исправлено.

[!] Модули: Комплекты товаров: Если опция имела модификатор цены, то выбор этой опции у товара из комплекта работал некорректно. Исправлено.

[!] Модули: Комплекты товаров: На странице с акциями был невыровненный заголовок "Доступные комплекты". Исправлено.

[!] Модули: Комплекты товаров: Настройка "Отслеживать количество" не влияла на отображение комплекта товаров. Исправлено.

[!] Модули: Комплекты товаров: Не менялось изображение вариации при смене характеристики. Исправлено.

[!] Модули: Комплекты товаров: Нельзя было создать комплект товаров со смешанными значениями "Любые комбинации опций" и "Любая вариация". Исправлено.

[!] Модули: Комплекты товаров: Отображалась кнопка удаления товара из комплекта при наличии прав "Только просмотр". Исправлено.

[!] Модули: Комплекты товаров: После добавления комплекта товаров в корзину не открывалось всплывающее окно выбора опций товара. Исправлено.

[!] Модули: Комплекты товаров: При выключенном модуле "Вариации товаров" добавление комплекта товаров в корзину не работало. Исправлено.

[!] Модули: Комплекты товаров: Комплекты товаров отображались на странице акций при выключенном модуле. Исправлено.

[!] Модули: Комплекты товаров: Форматирование описания комплекта товаров не сохранялось. Исправлено.

[!] Модули: Мобильное приложение: Рекламный баннер мобильного приложения отображался при просмотре страниц магазина в мобильном приложении. Исправлено.

[!] Модули: Мобильное приложение: Сплэш-изображения отображались не на весь экран на Android. Исправлено.

[!] Модули: Мобильное приложение: Страницы отображались некорректно на разных языках. Исправлено.

[!] Модули: Рассылки: Подписчики: В расширенном поиске отсутствуют поля "Язык" и "Период". Исправлено.

[!] Модули: Теги: Уведомление о несохраненных изменениях не появлялось. Исправлено.

[!] Модули: ЮКасса: Обновление заказа с включённым модулем приводило к фатальной ошибке. Исправлено.

[!] Модули: CommerceML: В некоторых случаях при синхронизации не изменялись названия товаров-вариаций. Исправлено.

[!] Модули: CommerceML: При синхронизации товару могли быть назначены некорректные значения числовых характеристик. Исправлено.

[!] Модули: CommerceML: В старом модуле после обмена данными могла изменяться цель у характеристик, присутствующих у товаров в импорте. Исправлено.

[!] Модули: CommerceML: Вариации товаров: В экспортированном заказе товар может выгружаться без указания, что он вариация. Исправлено.

[!] Опции: Недоступные комбинации: Недоступные комбинации опций работали некорректно. Исправлено.

[!] Отчеты о продажах: Отображались неправильные результаты отчета о продажах, если для отчета было выбрано несколько тарифных зон с одной и той же страной и разными регионами. Исправлено.

[!] Оформление заказа: После изменения адреса доставки сбрасывались данные адреса плательщика. Исправлено.

[!] Оформление заказа: При попытке перейти на страницу оформления заказа возникали предупреждения PHP, если не было активных способов оплаты. Исправлено.

[!] Оформление заказа: Цифровые товары: Если в корзине были только цифровые товары, нельзя было оформить заказ при включенной настройке "Показывать недоступные способы доставки". Исправлено.

[!] Панель администратора: Дизайн: Атрибут класса дублировался на странице смены пароля. Исправлено.

[!] Панель администратора: Дизайн: На мобильных не отображался заголовок страницы при закрытой витрине. Исправлено.

[!] Панель администратора: Контекстное меню: Текст выпадающего меню для изменения статуса менялся в зависимости от страницы. Исправлено.

[!] Поддержка HiDPI: Owl carousel: Отложенная загрузка изображений не работала. Исправлено.

[!] Пользователи: Не работала настройка "Обязательно менять пароль при первом входе". Исправлено.

[!] Пользователи: Некоторые данные полей профиля удалялись при оформлении заказа с использованием второго профиля. Исправлено.

[!] Пользователи: Пользователям разрешалось регистрироваться с использованием некорректного адреса электронной почты. Исправлено.

[!] Поля профиля: Значения дополнительных полей сохранялись для всех профилей пользователя. Исправлено.

[!] Привилегии: Категории: Администратору с правами "Только просмотр" была доступна страница создания категории. Исправлено.

[!] Привилегии: Опции: Некорректно отображалась форма опций товара при отсутствии у группы пользователей прав на редактирование опций. Исправлено.

[!] Профили: Могла возникнуть ошибка при создании нового профиля. Исправлено.

[!] Профили: Невозможно было заполнить поле Область/район в разделе Адрес плательщика при создании покупателя из панели администратора, если поле было обязательным. Исправлено.

[!] Редактировать контент: После режима редактирования текста ломались блоки, вставленные в контент страницы. Исправлено.

[!] Редактор тем: Редактировать тексты: Редактирование текста с помощью Redactor II не работало. Исправлено.

[!] Товары: В некоторых случаях страница "Обновить товары" не отображалась на всю ширину. Исправлено.

[!] Товары: На вкладке "Вариации" уведомление о несохраненных данных отображалось при выделении товара. Исправлено.

[!] Товары: При создании товара название варианта, выбранного в поле "Отображение карточки товара" по умолчанию, не соответствовало действительности. Исправлено.

[!] Товары: Совместное использование: При копировании информации из существующей витрины не копировалась позиция товара. Исправлено.

[!] Товары: Список сравнения: Скрытый товар не добавлялся в список сравнения. Исправлено.

[!] Товары: Уведомления: Уведомление о появлении товара в наличии могли отправляться ошибочно. Исправлено.

[!] Товары: Характеристики: Выбранная страница сбрасывалась при изменении варианта. Исправлено.

[!] Экспорт/Импорт: Последнее поле в строке импорта не читалось, если это последняя строка в файле, значение поля было пустым и отсуствовал символ конца строки. Исправлено.

[!] Экспорт/Импорт: Характеристики: Варианты характеристик с названием "0" не импортировались. Исправлено.

[!] Экспорт/Импорт: Характеристики: Присутствовала возможность импортировать характеристику с типом, недоступным для цели. Исправлено.

[!] Ядро: Метод Registry::ifGet всегда возвращал значение переданное в параметре $default, если значение самой переменной было false или 0. Исправлено

[!] Ядро: Шаблоны: Хуки: Хуки расположенные в папках, которые являлись символьными ссылками на другие папки, не работали. Исправлено.

[!] JS: Элементы главного меню отображались некорректно, если курсор был наведен на меню при загрузке страницы. Исправлено.

[!] Multi-Vendor: Бухгалтерский учет: Баланс продавца мог быть рассчитан некорректно после обновления заказа. Исправлено.

[!] Multi-Vendor: В некоторых случаях на странице списка пользователей продавец мог просмотреть данные администраторов маркетплейса и администраторов других продавцов. Исправлено.

[!] Multi-Vendor: Дизайн: Макеты: В панели продавца отображалась ссылка "Мета-данные и др." с недоступным для продавца функционалом. Исправлено.

[!] Multi-Vendor: Заказы: Добавление товаров другого продавца при редактировании заказа удаляло первоначальные товары из заказа. Исправлено.

[!] Multi-Vendor: Мастер настройки маркетплейса: Выбор бизнес-модели мог привести к нескольким PHP Error. Исправлено.

[!] Multi-Vendor: Модули: Бонусные баллы: Промо-акции: Баллы за выполненный заказ, являющиеся наградой за примененную промо-акцию, не присуждались, если продавец подтверждал выполнение заказа. Исправлено.

[!] Multi-Vendor: Модули: Карта сайта для Yandex и Google: Категории, недоступные для определенной витрины, могли быть включены в карту сайта этой витрины. Исправлено.

[!] Multi-Vendor: Модули: Конфигуратор панели продавцов: Настройки цвета применялись не везде. Исправлено.

[!] Multi-Vendor: Модули: Конфигуратор панели продавцов: Поле "Название" дублировалось в настройках модуля. Исправлено.

[!] Multi-Vendor: Модули: Магазины и пункты самовывоза: Пункты выдачи не были привязаны к поставщику при импорте. Исправлено.

[!] Multi-Vendor: Модули: Оплата от продавцов администратору: Пополнение баланса подтверждало все выплаты продавца, даже если баланс все ещё оставался отрицательным. Исправлено.

[!] Multi-Vendor: Модули: Оплата от продавцов администратору: Название товара "Оплата задолженности" невозможно было изменить, если в плане продавца были ограничения по категориям. Исправлено.

[!] Multi-Vendor: Модули: Оплата от продавцов администратору: Продавец в статусе "Приостановлен" мог видеть оповещение о долге, даже с положительным балансом. Исправлено.

[!] Multi-Vendor: Модули: Премодерация данных продавцов: Администраторы, которые не имели доступа к товарам, видели на главной странице панели администратора информацию по товарам. Исправлено.

[!] Multi-Vendor: Модули: Премодерация данных продавцов: Кнопка "Утверждение товаров" пропадала при активации модуля "Общие товары для продавцов". Исправлено.

[!] Multi-Vendor: Модули: Тарифные планы продавцов: Нельзя было выбрать тарифный план для продавца в панели администратора, если было создано много тарифных планов. Исправлено.

[!] Multi-Vendor: Панель продавца: Панель инструментов: Блоки управления были не выровнены. Исправлено.

[!] Multi-Vendor: Панель продавца: Языки: Если активно большое количество языков, некоторые языки невозможно было выбрать. Исправлено.

[!] Multi-Vendor: Пользователи: Заказы: При переходе на страницу покупателя отображалась 404 ошибка, если заказ был оформлен администратором продавца. Исправлено.

[!] Multi-Vendor: Поля профиля: При создании нового поля профиля продавца возникала ошибка PHP Notice. Исправлено.

[!] Multi-Vendor: Поля профиля: Информация о продавце: Для поля "Компания" вместо флажка отображалась радиокнопка. Исправлено.

[!] Multi-Vendor: Продавцы: Некорректно отображался регион на странице информации о продавце. Исправлено.

[!] Multi-Vendor: Способы доставки: Галочка "Использовать для всех новых продавцов" была доступна, даже если способу доставки был назначен владелец. Исправлено.

[!] Multi-Vendor: Товары: Опции: Администратор мог массово применить к товарам опции, принадлежащие продавцам. Исправлено.

[!] Multi-Vendor Plus: Модули: Общие товары для продавцов: Цена товаров с нулевым количеством не показывалась. Исправлено.

[!] Multi-Vendor Plus: Модули: Общие товары для продавцов: Общие товары не отображали информацию о наличии товаров. Исправлено.

[!] Multi-Vendor Plus: Модули: Общие товары для продавцов: При импорте пресета продавца в панели администратора создавались новые общие товары, вместо товаров продавца. Также при импорте пресета продавца могла появляться ошибка PHP TypeError. Исправлено.

[!] Multi-Vendor Plus: Модули: Оплата напрямую продавцам: Общие товары для продавцов: Было невозможно добавить предложение общего товара продавца в корзину. Исправлено.

[!] Multi-Vendor Ultimate: Модули: Общие товары для продавцов: Склады: Опция "Быстрая покупка одного из предложений" неправильно работала со складами. Исправлено.

[!] Multi-Vendor Ultimate: Модули: Общие товары для продавцов: Некорретный список выбора категории отображался при создании общего товара, в случае, если в магазине было более одной витрины и разные продавцы были прикреплены к разным витринам. Исправлено.

[!] Multi-Vendor Ultimate: Модули: Фулфилмент от маркетплейса: Информация о способе доставке отсутствовала, если в заказ был добавлен бесплатный товар по промо-акции. Исправлено.

[!] Multi-Vendor Ultimate: Модули: Фулфилмент от маркетплейса: Служба доставки — СДЭК: Выбранный пункт доставки не отображался на детальной странице заказа. Исправлено.

[!] Ultimate: Модули: Магазины и пункты самовывоза: Не работал импорт пунктов самовывоза с разных витрин. Исправлено.

[!] Ultimate: Товары: Значения полей для товаров, размещенных на нескольких витринах, не сохранялись без изменения хотя бы одного поля. Исправлено.

[!] Ultimate: Модули: Склады: Импорт: Количество товаров на складе обнулялось некорректно при импорте. Исправлено.

[!] Ultimate: Модули: Склады: Количество товаров на нескольких складах рассчитывалось неправильно. Исправлено.

[!] Ultimate: Модули: Склады: Некорректно работал расширенный поиск по количеству товаров. Исправлено.

[!] Ultimate: Модули: Склады: Товар не добавлялся в корзину при включенном предзаказе. Исправлено.

[!] Ultimate: Модули: Склады: Удаление тарифной зоны могло привести к ошибкам. Исправлено.

[!] Ultimate: Модули: Склады: Уведомление о появлении товара в наличии в определённой тарифной зоне не отправлялось покупателю. Исправлено.

Сервис-паки
===========

----------
4.14.3.SP1
----------

Новая функциональность и улучшения
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

[+] Multi-Vendor Plus: Хуки: Добавлен новый хук 'master_products_create_vendor_product_pre', который проверяет соответствие между допустимым количеством товаров в тарифном плане продавца и количеством создаваемых товарных предложений для общего товара.

Исправления ошибок
~~~~~~~~~~~~~~~~~~

[!] Заказы: Не отображался менеджер заказа в списке заказов. Исправлено.

[!] Модули: Центр сообщений: Вариации товаров: Окно "Задать вопрос" отображалось некорректно после переключения вариации товара в окне быстрого просмотра. Исправлено.

[!] Multi-Vendor Plus: Модули: Общие товары для продавцов: Тарифные планы продавца: Ограничение на количество продаваемых товаров в тарифном плане продавца не влияло на общие товары для продавцов. Исправлено.

[!] Multi-Vendor Ultimate: Модули: Общие товары для продавцов: Склады: Цена лучшего предложения не соответствовала тарифной зоне покупателя. Исправлено.

[!] Ultimate: Модули: Склады: Товары из наличия, для которых не было определено количество по складам, не отображились на витрине. Исправлено.

[!] Ultimate: Модули: Склады: Сохранение изменений у товара со складами запишет ему некорректное суммарное количество на складах для всех витрин. Исправлено.