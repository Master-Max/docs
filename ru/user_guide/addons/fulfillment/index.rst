***********************************
“Фулфилмент от маркетплейса [Beta]"
***********************************

.. note:: 

    Этот модуль есть только в **CS-Cart для маркетплейсов**. Перед использованием убедитесь, что модуль :doc:`/user_guide/addons/vendor_plans/index` установлен и включен.

.. contents::
    :backlinks: none
    :local:

Функциональность
================

По умолчанию в Multi-Vendor каждый продавец сам доставляет свои товары, и покупатели оплачивают доставку отдельно каждому продавцу. В рамках одного маркетплейса доставкой могут заниматься и продавцы, которые доставляют товары сами, и продавцы, за которых это делает маркетплейс. Когда заказы доставляются маркетплейсом, то стоимость доставки также уходит в пользу маркетплейса и только один раз (даже если продавцов много).

Единая доставка товаров от разных продавцов реализуется модулем “Фулфилмент от маркетплейса [Beta]". Так как услуга фулфилмента стоит маркетплейсу денег, то эта стоимость закладывается в тарифные планы. Когда в магазине работает модуль, продавцы еще на этапе регистрации видят, какие тарифные планы имеют преимущество в виде фулфилмента.

.. fancybox:: img/vendor_plans.png
    :alt: Фулфилмент — свойство тарифных планов.

В зависимости от наличия фулфилмента в тарифных планах продавцов, модуль работает по-разному. 

#. Если покупатель выбрал несколько товаров от разных продавцов с включённым фулфилментом, доставка для всех товаров будет одна — от маркетплейса.

#. Если покупатель выбрал несколько товаров от разных продавцов, часть которых не имеют фулфилмента в своих тарифных планах, тогда будет как минимум две доставки:

   * одна от маркетплейса — для всех продавцов с фулфилментом;

   * еще по одной для каждого продавца без фулфилмента.

   .. fancybox:: img/one_shipping.png
       :alt: Все товары от продавцов с фулфилментом.

       Одна доставка — товары от продавцов с фулфилментом доставляет маркетплейс.

   .. fancybox:: img/several_shippings.png
       :alt: Товары от продавцов и с фулфилментом, и без.

       Две доставки — товары от продавцов с фулфилментом доставляет маркетплейс, продавец без фулфилента доставялет свои товары сам. 

Как настроить продавцам фулфилмент
==================================

У самого модуля настроек нет. Включить доставку товаров конкретного продавца через маркетплейс можно следующим способом:

#. Установите модуль так же, :doc:`как и любой другой модуль </user_guide/addons/1manage_addons>`.

#. Перейдите на страницу **Продавцы → Тарифные планы для продавцов**. Выберете тарифный план, на котором будет предлагаться продавцам фулфилмент.

#. Откройте настройки этого тарифного плана. На вкладке **Доставка** поставьте галочку **Фулфилмент от маркетплейса**.

#. Нажмите **Сохранить**.

#. Перейдите на страницу **Администрирование → Доставка и налоги → Способы доставки**. :doc:`Создайте способ доставки </user_guide/shipping_and_taxes/shipping_methods/add_shipping_method>` или найдите уже существующий, который будет предлагаться продавцам с фулфилментом. Чтобы способ доставки предлагался продавцам с фулфилментом, на вкладке **Общее** в настройках этого способа **Владельцем** должен быть *Маркетплейс*.

Теперь все товары от продавца с этим планом будет доставлять маркетплейс.
   
.. fancybox:: img/enable_fulfillment.png
    :alt: Включение фулфилмента у тарифного плана.

Изменения в логике после включения модуля
=========================================

#. Пока модуль выключен, продавцы создают свои способы доставки или пользуются теми, которые создал маркетплейс. В любом случае деньги покупателя за доставку уходят продавцу.

#. Если модуль включить, то способы доставки, у которых владельцем был маркетплейс, становятся доступны только продавцам с фулфилментом. Маркетплейс получает деньги за доставку такими способами. Адрес маркетплейса служит исходным адресом для расчёта, если доставка идёт через Почту России, СДЭК или другой способ доставки с расчётом в реальном времени.

#. Когда модуль выключается, старые способы доставки возвращаются продавцам. Теперь продавцы снова получают деньги за доставку.