***********************************
“Фулфилмент от маркетплейса [Beta]"
***********************************

.. note:: 

    Этот модуль есть только в **CS-Cart для маркетплейсов**. Перед использованием убедитесь, что модуль :doc:`/user_guide/addons/vendor_plans/index` установлен и включен.

.. contents::
    :backlinks: none
    :local:

Функциональность
================

В рамках одного маркетплейса могут быть два варианта поведения магазина после оформления заказа:

* Продавцы доставляют свои товары способами доставки, которые они создали, получают за доставку деньги. Так как каждый продавец доставляет отдельно, то и за доставку покупатель платит каждому продавцу. Так ведёт себя Multi-Vendor по умолчанию.

* Маркетплейс собирает у себя на складе товары от всех продавцов. Используя свои уже налаженные способы доставки, развозит покупателям товары. Деньги за доставку уйдут маркетплейсу и только один раз (даже если продавцов много).

При заказе товаров от разных продавцов удобен модуль “Фулфилмент от маркетплейса [Beta]". Он позволяет покупателям выбирать единый способ доставки для такого заказа. При этом маркетплейс доставляет товары и получает деньги от оплаты доставки. 

Так как услуга фулфилмента стоит маркетплейсу денег, то эту стоимость можно заложить в тарифные планы. Когда в магазине работает модуль, продавцы еще на этапе регистрации увидят, какие тарифные планы имеют преимущество в виде фулфилмента.

.. fancybox:: img/vendor_plans.png
    :alt: Фулфилмент — свойство тарифных планов.

В зависимости от наличия фулфилмента в тарифных планах продавцов, модуль работает по-разному. 

#. Если покупатель выбрал несколько товаров от разных продавцов с включённым фулфилментом, доставка для всех товаров будет одна — от маркетплейса.

#. Если покупатель выбрал несколько товаров от разных продавцов, часть которых не имеют фулфилмента в своих тарифных планах, тогда будет как минимум две доставки:

   * одна от маркетплейса — для всех продавцов с фулфилментом;

   * еще по одной для каждого продавца без фулфилмента.

   .. fancybox:: img/one_shipping.png
       :alt: Все товары от продавцов с фулфилментом.

       Одна доставка — товары от продавцов с фулфилментом доставляет маркетплейс.

   .. fancybox:: img/several_shippings.png
       :alt: Товары от продавцов и с фулфилментом, и без.

       Две доставки — товары от продавцов с фулфилментом доставляет маркетплейс, продавец без фулфилента доставялет свои товары сам. 

Как настроить продавцам фулфилмент
==================================

У самого модуля настроек нет. Включить доставку товаров конкретного продавца через маркетплейс можно следующим способом:

#. Установите модуль так же, :doc:`как и любой другой модуль </user_guide/addons/1manage_addons>`.

#. Перейдите на страницу **Администрирование → Доставка и налоги → Способы доставки**. Создайте способ доставки или найдите уже существующий, который будет предлагаться продавцам с фулфилментом. Для таких способов доставки исходным адресом для расчета стоимости доставки является адрес маркетплейса.

#. Перейдите на страницу **Продавцы → Тарифные планы для продавцов**. Выберете тарифный план, на котором будет предлагаться продавцам фулфилмент.

#. Откройте настройки этого тарифного плана. На вкладке **Доставка** поставьте галочку **Фулфилмент от маркетплейса**.

#. Нажмите **Сохранить**.

Теперь все товары от продавца с этим планом будет доставлять маркетплейс.

   .. fancybox:: img/enable_fulfillment.png
       :alt: Включение фулфилмента у тарифного плана.

Изменения в логике после включения модуля
=========================================

1. При выключенном модуле, продавцы либо создают свои способы доставки, либо ничего не настраивают и используют способы доставки, принадлежащие маркетплейсу. В любом случае деньги покупателя за доставку уходят продавцу.

2. При включении модуля старые способы доставки от маркетплейса становятся доступны только продавцам с фулфилментом. Маркетплейс получает деньги за доставку.

3. Когда модуль выключается, старые способы доставки возвращаются продавцам. Теперь продавцы снова получают деньги за доставку.