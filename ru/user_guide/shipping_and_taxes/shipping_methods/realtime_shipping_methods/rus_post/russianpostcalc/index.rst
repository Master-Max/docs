*********************************
Почта России (russianpostcalc.ru)
*********************************

Описание
========

Описываемая функциональность является частью модуля :doc:`/user_guide/addons/rus_post/index`. Позволяет рассчитывать стоимость доставки исходя из веса товара, стоимости товара, пункта назначения, индекса получателя и индекса отправителя. Для определения стоимости пересылки используется онлайн-калькулятор `russianpostcalc.ru <https://russianpostcalc.ru>`__.


Настройка способа доставки
==========================

Получите API ключ
+++++++++++++++++

#. Зарегистрируйтесь на сайте `russianpostcalc.ru <https://russianpostcalc.ru/register>`__. В окне регистрации заполните все поля (введенный в окне регистрации пароль является паролем авторизации для способа доставки *RussianPostCalc*), затем нажмите на кнопку **Регистрация**.

   .. fancybox:: img/image07.jpg
       :alt: Russian Post


#. После регистрации на указанный вами адрес электронной почты придет сообщение для подтверждения регистрации. Подтвердите регистрацию и зайдите в `личный кабинет <https://russianpostcalc.ru/user>`__. 

#. Для получения API ключа пройдите в **Настройки → API**.

   .. fancybox:: img/image19.jpg
       :alt: Russian Post


Создайте новый способ доставки
++++++++++++++++++++++++++++++

#. Установите модуль :doc:`/user_guide/addons/rus_post/index`.

#. Откройте страницу **Администрирование → Доставка и налоги → Способы доставки**.

#. :doc:`Создайте новый способ доставки </user_guide/shipping_and_taxes/shipping_methods/add_shipping_method>` и задайте :doc:`свойства способа доставки </user_guide/shipping_and_taxes/shipping_methods/shipping_method_attributes>`:

   * На вкладке **Общее**:
   
     * **Название** — введите название способа доставки, которое покупатель увидит при оформлении заказа; например, *Почта России*.

     * **Расчёт тарифа** — выберите вариант *В режиме реального времени*.

     * **Перевозчик** — выберите *Почта России*.

     * **Служба доставки** — выберите *Тарифный калькулятор (russianpostcalc.ru)*.

       .. fancybox:: img/shippings_009.png
           :alt: Russian Post
   
   * На вкладке **Настроить**:
   
     * **Ключ авторизации** — введите ключ API, полученный при регистрации на сайте russianpostcalc.ru.
       
     * **Пароль авторизации** — укажите пароль, введённый при регистрации на сайте.
     
     * **Тип отправления** — выберите один из вариантов:
     
       * *Ценная посылка, обычное отправление Почтой России*;
       
       * *Почта России 1 Класс*.
       
       .. fancybox:: img/shippings_008.png
           :alt: Russian Post

#. Перейдите на вкладку **Стоимость и сроки доставки**. Укажите тарифные зоны, в которых будет предложен способ доставки Почтой России.

#. Откройте вкладку **Проверить расчёт тарифа**. Нажмите на кнопку **Пересчитать цены**, чтобы рассчитать стоимость доставки. Расчёт осуществляется на основе веса, который вы указываете в форме, а также на основе :doc:`адреса компании и адреса покупателя по умолчанию </user_guide/shipping_and_taxes/address>`.

   .. fancybox:: img/pochta_003.png
       :alt: Russian Post
       
   .. note::
   
       Если способ доставки настроен неправильно, расчёт выдаст ошибку и укажет её причину. Подробнее о том, из-за чего еще может возникнуть ошибка при проверке расчёта тарифа, вы можете прочитать в :doc:`этой статье </user_guide/shipping_and_taxes/shipping_methods/test_button_error>`.
       
#. Нажмите **Сохранить**.
